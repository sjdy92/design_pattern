## Singleton Pattern (싱글톤 패턴)

생성자가 여러 차례 호출되더라도 실제로 생성되는 객체는 하나이고 최초 생성 이후에 호출된 생성자는 최초의 생성자가 생성한 객체를 리턴한다. 주로 공통된 객체를 여러개 생성해서 사용하는 DBCP(DataBase Connection Pool)와 같은 상황에서 많이 사용된다. (wiki)

싱글톤 패턴의 주요 특징은 다음과 같습니다. (chat gpt)
1. 오직 하나의 인스턴스: Singleton 클래스의 인스턴스는 오직 하나만 존재합니다. 다른 클래스나 모듈에서 해당 인스턴스를 여러 번 생성할 수 없습니다.
2. 전역적인 접근점: Singleton 인스턴스는 전역적으로 접근할 수 있는 접근점을 제공합니다. 이를 통해 어느 곳에서든 동일한 인스턴스에 접근할 수 있습니다.
3. 지연된 인스턴스화: Singleton 인스턴스는 처음으로 요청될 때까지 생성되지 않습니다. 이를 통해 리소스를 절약하고 성능을 향상시킬 수 있습니다.
4. 유일한 인스턴스 생성: Singleton 클래스는 자체적으로 인스턴스를 생성합니다. 이를 통해 외부에서 인스턴스 생성을 제어하고 중복 생성을 방지할 수 있습니다.

![image](https://github.com/sjdy92/design_pattern/assets/11484867/bfa27416-4711-4384-b297-8849541a732a)

## 예제

```java
public class Logger {
    private static Logger instance;

    private Logger() {
        // private 생성자로 외부에서의 인스턴스 생성 방지
    }

    public static Logger getInstance() {
        if (instance == null) {
            instance = new Logger();
        }
        return instance;
    }

    public void write(String message) {
        // 파일에 로그 작성
    }
}

public class Inventory {
    public consumeItem(ItemKey key) {
        //...
        Logger.getInstance().write("아이템이 사용되었습니다. itemkey: ${key}");
    }
}
```

## 전역 변수와의 차이.

전역 변수와의 차이점은 a) 생성 방식 b) 접근 방식이 다릅니다. 사실 미세한 차이지만 이 차이에 대한 의미가 있습니다. 
1. 싱글톤 패턴은 프로그램 실행 중 단 하나의 객체만 생성된다는 가정이 있습니다. 전역변수는 이러한 가정이 없기 때문에 여러 개의 객체가 존재할 수 있습니다.
2. 싱글톤 패턴은 getInstance() 라는 함수로 단일 접점이 생기고 이 객체는 다른 객체로 변경될 수 없다는 가정이 있습니다. 하지만 전역 변수는 어느 순간 다른 객체로 변경되었다고 해도 할말이 없죠.

## 지양해야 하는 이유

프로그램을 작성하다보면 실행 중 단 하나의 인스턴스만 생성되는 것을 보장하고 싶고 전역적으로 사용하고 싶을 때 사용하게 됩니다. 예를 들어 로그관리나 서버 모듈 혹은 DB 커넥션 관리 등이 이에 해당될 것 같습니다. 전역적으로 사용됨에 따라서 편리하지만, 이에 따른 부작용이 있습니다.

#### 전역적으로 접근이 가능함에 따른 부작용
1. 클래스와 관계 없는 곳에서 접근을 하여 사용될 가능성이 있습니다. 잘못쓰여질 여지가 있다는 것입니다.
2. 전역적으로 접근이 가능하기 때문에 여러 객체들과의 의존성이 생기게 된다. 이는 유지 보수와 테스트에 어려움을 초래합니다. 

## 의존성 주입과의 차이점.
의존성 주입(Dependency Injection)이란 외부에서 객체를 생성하여 사용될 객체에게 주입하는 방식입니다. 싱글톤과의 차이점은 

1. 의존성이 명시적으로 드러납니다. 이는 느슨한 결합의 형태로 싱글톤 패턴보다 유지 보수성과 확장성이 개선됩니다.
2. 주입 시 가짜(Mock) 객체를 주입하여 테스트가 용이합니다.

의존성 주입은 객체 간의 느슨한 결합을 통해 코드 유연성, 테스트 용이성, 확장성을 개선하는 데 중점을 두는 반면, 싱글톤 패턴은 전역적인 접근 가능성과 리소스 공유 등의 편리성을 제공하는 데 중점을 둡니다. 이러한 차이로 인해 의존성 주입은 싱글톤 패턴보다 일반적으로 권장되는 설계 원칙입니다.

## 결론 
1. 싱글톤 패턴은 프로그램이 실행되는 중에 단 한번만 생성되는 전역 객체이다.
2. "전역"적으로 사용됨에 따른 부작용을 조심하자.
3. 의존성 주입으로 대체할 수 없는지 고민해보자.
